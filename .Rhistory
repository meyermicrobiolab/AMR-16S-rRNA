theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
p1=plot_bar(ps_ra, fill="Class")+
facet_grid(.~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
samples$type<-factor(samples$type, levels=c("untreated","antibiotic"))
p1=plot_bar(ps_ra, fill="Class")+
facet_grid(.~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
View(sampledata)
View(samples)
View(samples)
p1=plot_bar(ps_ra, fill="Class")+
facet_grid(fraction.~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
p1=plot_bar(ps_ra, fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
View(otu)
sampledata$type<-factor(sampledata$type, levels=c("untreated","antibiotic"))
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
sampledata$type<-factor(sampledata$type, levels=c("untreated","antibiotic"))
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
samples$type<-factor(samples$type, levels=c("untreated","antibiotic"))
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
scale_y_continuous(breaks=seq(0, 10, 1))+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
scale_x_continuous(breaks=seq(0, 10, 1))+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
scale_x_continuous(breaks=seq(0, 10, 1))+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
library(dada2)
library(ggplot2)
library(phyloseq)
library(vegan)
library(knitr)
library(ALDEx2)
library(CoDaSeq)
library(ANCOMBC)
library(dplyr)
library(nloptr)
library(tibble)
writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
ps_ra<-transform_sample_counts(ps, function(OTU) OTU/sum(OTU))
# load in data and create phyloseq object
otu <- read.table("silva_nochloronomito_otu_table_ps5.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps5.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps5.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps #112 taxa and 35 samples
ps_ra<-transform_sample_counts(ps, function(OTU) OTU/sum(OTU))
get_taxa_unique(ps_ra, "Order") #37
get_taxa_unique(ps_ra, "Class") #19
get_taxa_unique(ps_ra, "Genus") #61
library(randomcoloR)
n <- 19
palette <- distinctColorPalette(n)
samples$type<-factor(samples$type, levels=c("untreated","antibiotic"))
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
scale_x_continuous(breaks=seq(0, 10, 1))+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
library(dada2)
library(ggplot2)
library(phyloseq)
library(vegan)
library(knitr)
library(ALDEx2)
library(CoDaSeq)
library(ANCOMBC)
library(dplyr)
library(nloptr)
library(tibble)
writeLines(capture.output(sessionInfo()), "sessionInfo.txt")
otu <- read.table("silva_nochloronomito_otu_table_ps5.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps5.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps5.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps
ps_ra<-transform_sample_counts(ps, function(OTU) OTU/sum(OTU))
get_taxa_unique(ps_ra, "Order") #37
get_taxa_unique(ps_ra, "Class") #19
get_taxa_unique(ps_ra, "Genus") #61
library(randomcoloR)
n <- 19
ps_ra<-transform_sample_counts(ps, function(OTU) OTU/sum(OTU))
get_taxa_unique(ps_ra, "Order") #37
get_taxa_unique(ps_ra, "Class") #19
get_taxa_unique(ps_ra, "Genus") #61
library(randomcoloR)
n <- 19
palette <- distinctColorPalette(n)
samples$type<-factor(samples$type, levels=c("untreated","antibiotic"))
p1=plot_bar(ps_ra, "tag" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
scale_x_continuous(breaks=seq(0, 10, 1))+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
# load in data and create phyloseq object
otu <- read.table("silva_nochloronomito_otu_table_ps5.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps5.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps5.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps #112 taxa and 35 samples
ps_ra<-transform_sample_counts(ps, function(OTU) OTU/sum(OTU))
get_taxa_unique(ps_ra, "Order") #37
get_taxa_unique(ps_ra, "Class") #19
get_taxa_unique(ps_ra, "Genus") #61
library(randomcoloR)
n <- 19
palette <- distinctColorPalette(n)
samples$type<-factor(samples$type, levels=c("untreated","antibiotic"))
p1=plot_bar(ps_ra, "tag" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
scale_x_continuous(breaks=seq(0, 10, 1))+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
View(samples)
p1=plot_bar(ps_ra, "tag" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
# load in data and create phyloseq object
otu <- read.table("silva_nochloronomito_otu_table_ps5.txt",sep="\t",header=TRUE, row.names=1)
taxon <- read.table("silva_nochloronomito_taxa_table_ps5.txt",sep="\t",header=TRUE,row.names=1)
samples<-read.table("metadata_ps5.txt",sep="\t",header=T,row.names=1)
OTU = otu_table(otu, taxa_are_rows=FALSE)
taxon<-as.matrix(taxon)
TAX = tax_table(taxon)
sampledata = sample_data(samples)
ps <- phyloseq(otu_table(otu, taxa_are_rows=FALSE),
sample_data(samples),
tax_table(taxon))
ps #112 taxa and 35 samples
ps_ra<-transform_sample_counts(ps, function(OTU) OTU/sum(OTU))
get_taxa_unique(ps_ra, "Order") #37
get_taxa_unique(ps_ra, "Class") #19
get_taxa_unique(ps_ra, "Genus") #61
library(randomcoloR)
n <- 19
palette <- distinctColorPalette(n)
samples$type<-factor(samples$type, levels=c("untreated","antibiotic"))
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
scale_x_continuous(breaks=seq(0, 10, 1))+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(type~fraction,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
n <- 19
palette <- distinctColorPalette(n)
samples$type<-factor(samples$type, levels=c("untreated","antibiotic"))
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
View(samples)
n <- 19
palette <- distinctColorPalette(n)
sample_data(ps_ra)$type<-factor(sample_data(ps_ra)$type, levels=c("untreated","antibiotic"))
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
n <- 19
palette <- distinctColorPalette(n)
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
```
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
n <- 19
palette <- distinctColorPalette(n)
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
n <- 19
palette <- distinctColorPalette(n)
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
n <- 19
palette <- distinctColorPalette(n)
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
pdf("barchart_Class.pdf",width=11)
p1=plot_bar(ps_ra, "colony" ,fill="Class")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
dev.off()
get_taxa_unique(ps_ra, "Family") #
n <- 37
palette <- distinctColorPalette(n)
p1=plot_bar(ps_ra, "colony" ,fill="Order")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Class), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
p1=plot_bar(ps_ra, "colony" ,fill="Order")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Order), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
n <- 37
palette <- distinctColorPalette(n)
p1=plot_bar(ps_ra, "colony" ,fill="Order")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Order), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
pdf("barchart_Order.pdf",width=11)
p1=plot_bar(ps_ra, "colony" ,fill="Order")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Order), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
dev.off()
n <- 61
palette <- distinctColorPalette(n)
p1=plot_bar(ps_ra, "colony" ,fill="Genus")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Genus), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
pdf("barchart_Genus.pdf",width=11)
p1=plot_bar(ps_ra, "colony" ,fill="Genus")+
facet_grid(fraction~type,scales="free",space="free")+
geom_bar(aes(fill=Genus), stat="identity",position="stack")+
theme_bw()+
theme(strip.text=element_text(face="bold", size=12))+
theme(axis.text.x=element_text(size=12))+
theme(axis.text.y=element_text(size=12))+
scale_fill_manual(values=palette)+
#theme(axis.title.x = element_blank())+
theme(legend.position = "bottom")
p1
dev.off()
